<!DOCTYPE html>
<html>
<head>
  <title>ZXS Ultraviolet Proxy</title>
</head>
<body>
  <p>Loading Ultraviolet...</p>

  <script src="uv/uv.bundle.js"></script>
  <script src="uv/uv.config.js"></script>
  <script>
    window.addEventListener('load', async () => {
      if ('serviceWorker' in navigator) {
        await navigator.serviceWorker.register('uv/uv.sw.js', {
          scope: '/s/internet/',
        });
      }

      const hash = window.location.hash;
      if (hash.length > 1) {
        const target = decodeURIComponent(hash.slice(1));
        const encoded = __uv$config.prefix + Ultraviolet.codec.xor.encode(target);
        window.location.replace(encoded);
      }
    });
  </script>
<script>
  window.addEventListener('load', async () => {
  // Register service worker
  if ('serviceWorker' in navigator) {
    await navigator.serviceWorker.register('uv/uv.sw.js', {
      scope: '/s/internet/',
    });
  }

  // Wait until Ultraviolet is ready
  const waitForUV = () => new Promise((resolve) => {
    const check = () => (window.Ultraviolet ? resolve() : setTimeout(check, 50));
    check();
  });

  await waitForUV();

  const hash = window.location.hash;
  if (hash.length > 1) {
    const url = decodeURIComponent(hash.slice(1));
    const encoded = __uv$config.prefix + Ultraviolet.codec.xor.encode(url);
    window.location.replace(encoded);
  }
});

</script>
</body>
</html>
